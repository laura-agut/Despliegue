
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://laura-agut.github.io/Despliegue/Ud4%20Servicios%20de%20red%20DNS%20y%20LDAP/P1DNS/">
      
      
        <link rel="prev" href="../../Ud3%20Servidores%20web/T04/">
      
      
        <link rel="next" href="../P2DNSDocker/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>Pr√°ctica 1 - Configuraci√≥n de un servidor DNS - Despliegue de aplicaciones web</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#practica-1-configuracion-de-un-servidor-dns" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Despliegue de aplicaciones web" class="md-header__button md-logo" aria-label="Despliegue de aplicaciones web" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Despliegue de aplicaciones web
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Pr√°ctica 1 - Configuraci√≥n de un servidor DNS
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="B√∫squeda" placeholder="B√∫squeda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando b√∫squeda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegaci√≥n" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Despliegue de aplicaciones web" class="md-nav__button md-logo" aria-label="Despliegue de aplicaciones web" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Despliegue de aplicaciones web
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Despliegue de aplicaciones web
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Ud0 Introduccion
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Ud0 Introduccion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ud0%20Introduccion/Ud0_1Introalmodulo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.1. Introducci√≥n al m√≥dulo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ud0%20Introduccion/Ud0_2AWS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.2. Introducci√≥n a AWS Academy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ud0%20Introduccion/ejercicio-final-ebs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üß™ Ejercicio final: modifica, prueba en local y despliega en Elastic Beanstalk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Pr√°cticas
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Pr√°cticas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ud0%20Introduccion/P0_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P0.1. Linux Server en AWSAcademy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ud0%20Introduccion/P0_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P0.2 Windows Server en AWSAcademy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ud0%20Introduccion/P0_3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P0.3. Conceder acceso a un segundo administrador
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ud0%20Introduccion/P0_4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P0.4. Comandos b√°sicos Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ud0%20Introduccion/P0_5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P0.5: Despliegue Java en AWS Elastic Beanstalk
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="practica-1-configuracion-de-un-servidor-dns">Pr√°ctica 1 - Configuraci√≥n de un servidor DNS</h1>
<div class="admonition note">
<p class="admonition-title">Nota importante</p>
<p>Es muy importante que antes de empezar esta pr√°ctica elimin√©is las entradas que hab√©is ido introduciendo hasta ahora en vuestro archivo <code>/etc/hosts</code> para asegurarnos que realmente la resoluci√≥n de nombres va a nuestro servidor DNS. Si no hac√©is esto, resolver√° los nombres, pensar√©is que est√° bien pero en realidad estar√° mal.</p>
</div>
<h2 id="creacion-de-la-maquina-virtual">Creaci√≥n de la m√°quina virtual</h2>
<p>Para empezar, entra en AWS Academy y crea un nuevo EC2 Debian con estas caracter√≠sticas. </p>
<ul>
<li>Ll√°male P5ServidorDNS.</li>
<li>Dale los recursos que te ofrece por defecto.</li>
<li>Crea un Grupo de seguridad con el nombre P5ServidorDNS y abre los puertos necesarios para que una m√°quina externa pueda consultarlo.</li>
<li>Arranca la m√°quina y actual√≠zala para que cuente con las √∫ltimas versiones de todos los paquetes.</li>
</ul>
<p>Para esta pr√°ctica es interesante que nuestro servidor DNS tenga una IP fija y no cambie cada vez que arranquemos nuestro servidor. </p>
<p>En Amazon Web Services (AWS), las direcciones IP el√°sticas se utilizan para proporcionar direcciones IP fijas a instancias de Amazon EC2 u otros recursos de AWS. Aqu√≠ hay una gu√≠a b√°sica para asignar una direcci√≥n IP el√°stica a una instancia de EC2 en AWS:</p>
<ol>
<li>
<p>Inicia sesi√≥n en la Consola de AWS.</p>
</li>
<li>
<p>Ve al panel de EC2.</p>
</li>
<li>
<p>En el panel de navegaci√≥n izquierdo, haz clic en "Direcciones IP el√°sticas" bajo "Redes y Seguridad".</p>
</li>
<li>
<p>Asigna una nueva direcci√≥n IP el√°stica:</p>
<ol>
<li>Haz clic en "Asignar la direcci√≥n IP el√°stica".
    Simplemente haz clic en "Asignar" para obtener una nueva.</li>
</ol>
</li>
<li>
<p>Asocia la direcci√≥n IP el√°stica a una instancia:</p>
<ol>
<li>
<p>Selecciona la direcci√≥n IP el√°stica reci√©n creada.</p>
</li>
<li>
<p>Haz clic en "Acciones" y selecciona "Asociar la direcci√≥n IP el√°stica".</p>
</li>
<li>
<p>Selecciona la instancia a la que deseas asignar la direcci√≥n IP el√°stica y haz clic en "Associate". As√≠gnala a la instancia, no a la IP privada.</p>
</li>
</ol>
</li>
</ol>
<p>Despu√©s de estos pasos, la instancia de EC2 tendr√° una direcci√≥n IP el√°stica asociada, proporcion√°ndote una IP fija para esa instancia. Ten en cuenta que las direcciones IP el√°sticas no son gratuitas cuando no est√°n asociadas a una instancia en ejecuci√≥n, por lo que es una buena pr√°ctica desasociarlas y liberarlas cuando no las est√°s utilizando.</p>
<h2 id="herramientas-de-diagnostico-de-resolucion-de-nombres">Herramientas de diagn√≥stico de resoluci√≥n de nombres.</h2>
<p>Los programas <code>dig</code>, <code>host</code> y <code>nslookup</code> son herramientas de l√≠nea de comandos para realizar consultas a servidores de nombres. </p>
<ul>
<li>
<p><code>dig</code></p>
<p><code>dig</code> es la herramienta m√°s vers√°til y completa de estas utilidades de consulta. Tiene dos modos: un modo interactivo simple para una sola consulta y un modo por lotes que ejecuta una consulta para cada l√≠nea en una lista de varias l√≠neas de consulta.</p>
</li>
<li>
<p><code>host</code></p>
<p>La utilidad <code>host</code> enfatiza la simplicidad y facilidad de uso. Por defecto, convierte entre nombres de host y direcciones de Internet-</p>
</li>
<li>
<p><code>nslookup</code></p>
<p><code>nslookup</code> tiene dos modos: interactivo y no interactivo. El modo interactivo permite al usuario consultar servidores de nombres para obtener informaci√≥n sobre varios hosts y dominios, o imprimir una lista de hosts en un dominio. El modo no interactivo se utiliza para imprimir solo el nombre y la informaci√≥n solicitada para un host o dominio.</p>
</li>
</ul>
<p>Para instalar estas herramientas en nuestra Debian usaremos: </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>dnsutils<span class="w"> </span>
</code></pre></div>
<p>Comprobemos primero cu√°l es el servidor de nombres que tenemos configurado en nuestra EC2. Podemos saberlo con: </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$<span class="w"> </span>cat<span class="w"> </span>/etc/resolv.conf<span class="w"> </span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>...
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>nameserver<span class="w"> </span><span class="m">172</span>.31.0.2
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>search<span class="w"> </span>.
</code></pre></div>
<p>Toma nota de la IP del "nameserver", es decir, la IP del equipo al que nuestra m√°quina enviar√° las consultas de resoluci√≥n de nombres. En este caso nuestro DNS es 172.31.0.2.</p>
<p>Vamos a probar con <code>host</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>$<span class="w"> </span>host<span class="w"> </span>cisco.com
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>cisco.com<span class="w"> </span>has<span class="w"> </span>address<span class="w"> </span><span class="m">72</span>.163.4.185
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>cisco.com<span class="w"> </span>has<span class="w"> </span>IPv6<span class="w"> </span>address<span class="w"> </span><span class="m">2001</span>:420:1101:1::185
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>cisco.com<span class="w"> </span>mail<span class="w"> </span>is<span class="w"> </span>handled<span class="w"> </span>by<span class="w"> </span><span class="m">30</span><span class="w"> </span>aer-mx-01.cisco.com.
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>cisco.com<span class="w"> </span>mail<span class="w"> </span>is<span class="w"> </span>handled<span class="w"> </span>by<span class="w"> </span><span class="m">10</span><span class="w"> </span>alln-mx-01.cisco.com.
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>cisco.com<span class="w"> </span>mail<span class="w"> </span>is<span class="w"> </span>handled<span class="w"> </span>by<span class="w"> </span><span class="m">20</span><span class="w"> </span>rcdn-mx-01.cisco.com.
</code></pre></div>
<p>La salida es simple. Nos responde con los registros. En muchos casos esta informaci√≥n es m√°s que suficiente. Aunque no sabemos qu√© servidor DNS nos est√° dando la respuesta, si es autoritativa o no. Para nuestras pruebas se queda un poco corto.</p>
<p>Probemos ahora con <code>dig</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="l l-Scalar l-Scalar-Plain">$ dig cisco.com</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="l l-Scalar l-Scalar-Plain">; &lt;&lt;&gt;&gt; DiG 9.18.19-1~deb12u1-Debian &lt;&lt;&gt;&gt; cisco.com</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="l l-Scalar l-Scalar-Plain">;; global options</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">+cmd</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nt">;; Got answer</span><span class="p">:</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="nt">;; -&gt;&gt;HEADER&lt;&lt;- opcode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">QUERY, status</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NOERROR, id</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">57177</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="nt">;; flags: qr rd ra; QUERY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1, ANSWER</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1, AUTHORITY</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0, ADDITIONAL</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="nt">;; OPT PSEUDOSECTION</span><span class="p">:</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="nt">; EDNS: version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0, flags:; udp</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4096</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="nt">;; QUESTION SECTION</span><span class="p">:</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="l l-Scalar l-Scalar-Plain">;cisco.com.         IN  A</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="nt">;; ANSWER SECTION</span><span class="p">:</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="hll"><span class="l l-Scalar l-Scalar-Plain">cisco.com.      111 IN  A   72.163.4.185</span>
</span><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="nt">;; Query time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3 msec</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="hll"><span class="nt">;; SERVER</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.31.0.2#53(172.31.0.2) (UDP)</span>
</span><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="nt">;; WHEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Sat Nov 25 08:30:24 UTC 2023</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="nt">;; MSG SIZE  rcvd</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">54</span>
</code></pre></div>
<p>Vemos que obtenemos m√°s informaci√≥n. No s√≥lo nos devuelve la respuesta de la IP sino que adem√°s nos dice qu√© servidor DNS nos la est√° proporcionando.</p>
<p>Y finalmente vamos a probar con nslookup:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="l l-Scalar l-Scalar-Plain">$ nslookup cisco.com</span><span class="w"> </span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="l l-Scalar l-Scalar-Plain">Server</span><span class="p p-Indicator">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">172.31.0.2</span><span class="w"> </span><span class="c1">#(1)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="hll"><span class="nt">Address</span><span class="p">:</span><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">172.31.0.2#53</span><span class="w"> </span><span class="c1">#(2)</span>
</span><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="nt">Non-authoritative answer</span><span class="p">:</span><span class="w"> </span><span class="c1">#(3)</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="nt">Name</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">cisco.com</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="hll"><span class="nt">Address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">72.163.4.185</span><span class="w"> </span><span class="c1">#(4)</span>
</span><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="hll"><span class="nt">Name</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">cisco.com</span>
</span><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="nt">Address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2001:420:1101:1::185</span><span class="w"> </span><span class="c1">#(5)</span>
</code></pre></div>
<ol>
<li>
<p>Servidor DNS que nos est√° dando la respuesta</p>
</li>
<li>
<p>IP y puerto del servidor DNS que nos da la respuesta</p>
</li>
<li>
<p>El servidor DNS que nos contesta no tiene autoridad sobre la zona </p>
</li>
<li>
<p>La IP de cisco.com en IPv4</p>
</li>
<li>
<p>La IP de cisco. com en IPv6</p>
</li>
</ol>
<p>F√≠jate que en tu caso la IP de Server y Address pueden ser distintas si tu m√°quina virtual pregunta a un servidor DNS diferente. Prueba a ejecutar el mismo comando desde tu ordenador anfitri√≥n (el de casa o el aula). ¬øCoinciden los campos de Server y Address? ¬øY la IP de Cisco.com?</p>
<p>nslookup nos da una funcionalidad adicional. Podemos decirle cu√°l es el servidor DNS al que queremos consultar. Prueba a realizar la consulta anterior a un DNS de Google y observa la diferencia en la respuesta. Esto nos ser√° muy √∫til para consultar a nuestro servidor DNS desde cualquier m√°quina que no lo tenga configurado como servidor DNS principal.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="l l-Scalar l-Scalar-Plain">$ nslookup cisco.com 8.8.8.8</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="l l-Scalar l-Scalar-Plain">Server</span><span class="p p-Indicator">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">8.8.8.8</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nt">Address</span><span class="p">:</span><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">8.8.8.8#53</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="nt">Non-authoritative answer</span><span class="p">:</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="nt">Name</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">cisco.com</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="nt">Address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">72.163.4.185</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="nt">Name</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">cisco.com</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="nt">Address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2001:420:1101:1::185</span>
</code></pre></div>
Esta consulta lo que est√° haciendo es buscar la informaci√≥n de DNS para el dominio "cisco.com" utilizando el servidor DNS p√∫blico de Google, que tiene la direcci√≥n IP 8.8.8.8.</p>
<h2 id="instalacion-de-servidor-dns">Instalaci√≥n de servidor DNS</h2>
<p>Bind es el est√°ndar de facto para servidores DNS. Es una herramienta de software libre y se distribuye con la mayor√≠a de plataformas Unix y Linux, donde tambi√©n se le conoce con el sobrenombre de named (name daemon). Bind9 es la versi√≥n recomendada para usarse y es la que emplearemos.</p>
<p>Para instalar el servidor DNS en un servidor Debian, usaremos los repositorios oficiales. Por ello, podremos instalarlo como cualquier paquete en Debian:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>bind9<span class="w"> </span>bind9utils<span class="w"> </span>bind9-doc<span class="w"> </span>
</code></pre></div>
<p>Comprueba si el servicio bind 9 ya est√° funcionando.</p>
<p>Una vez instalado el servicio ya funcionar√° con las opciones b√°sicas. </p>
<p>En una prueba anterior hemos probado a preguntar al servidor DNS que tenemos configurado, pero lo que nos interesa ahora es preguntarle al que acabamos de instalar. Desde nuestro servidor Debian vamos a preguntarle al servidor bind9.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="l l-Scalar l-Scalar-Plain">$ nslookup cisco.com 127.0.0.1</span><span class="w"> </span><span class="c1">#(1)</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nt">Server</span><span class="p">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="nt">Address</span><span class="p">:</span><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1#53</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="nt">Non-authoritative answer</span><span class="p">:</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="nt">Name</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">cisco.com</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="nt">Address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">72.163.4.185</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="nt">Name</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">cisco.com</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="nt">Address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2001:420:1101:1::185</span>
</code></pre></div>
<ol>
<li>Inclu√≠mos al final la IP del servidor al que queremos preguntar. Vemos como en Server y Address nos est√° contestando 127.0.0.1 que no es m√°s que localhost, nuestra propia m√°quina. Comprobamos c√≥mo nuestro servidor DNS y es capaz de darnos respuesta.</li>
</ol>
<p>Prueba ahora a consultar a nuestro servidor DNS desde tu m√°quina anfitri√≥n. Para ello deber√°s consultar a su IP p√∫blica. ¬øObtienes respuesta? ¬øPor qu√© crees que obtienes esa respuesta? Lo veremos m√°s adelante.</p>
<p>Una vez comprobado que nuestro servidor DNS est√° funcionando correctamente vamos a cambiar el DNS al que consulta nuestro servidor Debian en <code>/etc/resolv.conf</code>. Sin embargo, este archivo puede ser gestionado autom√°ticamente y sobrescrito por herramientas como <code>systemd-resolved</code> o <code>dhclient</code>. Para hacer cambios permanentes en los servidores DNS, es recomendable modificar la configuraci√≥n en el lugar correspondiente.</p>
<p>Nuestro sistema usa <code>systemd-resolved</code>. Para cambiar la configuraci√≥n DNS de forma permanente, edita el archivo de configuraci√≥n <code>/etc/systemd/resolved.conf</code>. Dentro del archivo, busca la secci√≥n [Resolve] y agrega o modifica la l√≠nea DNS= con tus servidores DNS preferidos, separados por espacios. En nuestro caso usaremos la propia m√°quina 127.0.0.1.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="o">[</span>Resolve<span class="o">]</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nv">DNS</span><span class="o">=</span><span class="m">127</span>.0.0.1
</code></pre></div>
<p>Reinicia systemd-resolved para aplicar la nueva configuraci√≥n:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>systemd-resolved
</code></pre></div>
<p>Comprueba ahora que en <code>/etc/resolv.conf</code> tienes <code>nameserver=127.0.0.1</code> como primera opcion.</p>
<p>Prueba ahora a consultar la IP de cisco.com con <code>dig</code> y <code>nslookup</code> y comprueba que servidor te responde.</p>
<p>Es importante recordar aqu√≠ que no tenemos configurada en ninguna parte la IP de ning√∫n servidor DNS externo. Por tanto, ¬øc√≥mo es capaz nuestro servidor de contestarnos cuando le preguntamos por la IP de cisco.com? Por defecto bind9 realizar√° una resoluci√≥n iterativa, preguntando primero a los servidores ra√≠z de internet, si estos no tienen, preguntar√° a los servidores TLD y despu√©s a los servidores autoritativos de dominio.</p>
<h2 id="configuracion-del-servidor">Configuraci√≥n del servidor</h2>
<!-- 
Puesto que s√≥lo vamos a utilizar IPv4, vamos a dec√≠rselo a Bind, en su archivo general de configuraci√≥n, que es el siguiente:

<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>/etc/default/named
</code></pre></div>

Y para indicarle que s√≥lo use IPv4, debemos modificar la l√≠nea siguiente con el texto resaltado:

<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>OPTIONS = &quot;-u bind -4&quot;
</code></pre></div>


En primer lugar vamos a repasar el fichero de configuraci√≥n de bind ```/etc/default/named```:

<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>$<span class="w"> </span>cat<span class="w"> </span>/etc/default/named<span class="w"> </span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c1">#</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c1"># run resolvconf?</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="nv">RESOLVCONF</span><span class="o">=</span>no
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c1"># startup options for the server</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">&quot;-u bind&quot;</span>
</code></pre></div>

La variable RESOLVCONF indica si BIND9 debe interactuar con resolvconf. Si est√° configurado en yes, BIND9 utilizar√° resolvconf para gestionar los archivos de configuraci√≥n de resoluci√≥n de DNS. Es decir, que lo que bind9 no sepa resolver se lo preguntar√° al servicio reslovconf igual que le pregunta cualquier otro programa, como el navegador web. Por eso, sin necesidad de configurar nada m√°s, bind sabr√° respondernos a cualquier pregunta de resoluci√≥n. Aquellas que no sepa, las consultar√° a resolvconf.
-->

<p>El archivo de configuraci√≥n principal de Bind es:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>/etc/bind/named.conf
</code></pre></div>
<p>Si lo consultamos veremos lo siguiente:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>$ cat /etc/bind/named.conf
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>// This is the primary configuration file for the BIND DNS server named.
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>//
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>// Please read /usr/share/doc/bind9/README.Debian for information on the
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>// structure of BIND configuration files in Debian, *BEFORE* you customize
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>// this configuration file.
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>//
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>// If you are just adding zones, please do that in /etc/bind/named.conf.local
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>include &quot;/etc/bind/named.conf.options&quot;;
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>include &quot;/etc/bind/named.conf.local&quot;;
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>include &quot;/etc/bind/named.conf.default-zones&quot;;
</code></pre></div>
<p>Este archivo sirve simplemente para aglutinar o agrupar a los archivos de configuraci√≥n que usaremos. Estos 3 includes hacen referencia a los 3 diferentes archivos donde deberemos realizar la verdadera configuraci√≥n, ubicados en el mismo directorio.</p>
<h3 id="configuracion-namedconfoptions">Configuraci√≥n <em>named.conf.options</em></h3>
<p>Es una buena pr√°ctica que hag√°is siempre una copia de seguridad de un archivo de configuraci√≥n cada vez que vay√°is a realizar alg√∫n cambio:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>sudo<span class="w"> </span>cp<span class="w"> </span>/etc/bind/named.conf.options<span class="w"> </span>/etc/bind/named.conf.options.backup
</code></pre></div>
<p>Recuerda que si preguntabas antes con nslookup desde el propio servidor obten√≠amos respuesta pero si le hacemos la consulta desde nuestra m√°quina local nos daba "REFUSED". Esto es porque BIND9 solo permite consultas locales por defecto. Para permitir todas las solicitudes a√±adir√≠amos la directiva:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>allow-query<span class="w"> </span><span class="o">{</span><span class="w"> </span>any<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</code></pre></div>
<p>Puedes comprobar que el archivo de configuraci√≥n es correcto con:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>sudo<span class="w"> </span>named-checkconf
</code></pre></div>
<p>Si no aparecen errores, entonces todo est√° en orden. Reinicia el servicio y prueba a consultar nuevamente desde tu m√°quina anfitri√≥n. ¬øRecibe ahora la respuesta esperada?</p>
<p>Con esta configuraci√≥n b√°sica ya hemos comprobado que nuestro servidor DNS est√° funcionando y respondiendo a peticiones de la propia m√°quina y de otras externas.</p>
<h4 id="desactivar-la-recursividad">Desactivar la recursividad</h4>
<p>En la teor√≠a vimos que cuando un servidor DNS tiene la recursividad activada dar√° una respuesta completa cuando le consulten. Si no tiene la respuesta buscar√° la forma de conseguirla para dar una respuesta al cliente. Este es el estado por defecto cuando instalamos bind9. Pero si queremos desactivar la recursividad incluiremos la siguiente directiva de configuraci√≥n en <code>/etc/bind/named.conf.options</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="l l-Scalar l-Scalar-Plain">recursion no;</span>
</code></pre></div>
<p>Incluye la directiva, reinicia el servicio y haz una consulta por cualquier dominio, por ejemplo "cisco.com". Observa el resultado.</p>
<p>Puedes comentar la directiva para dejar la recursividad activada de momento.</p>
<h4 id="configuracion-de-los-forwarder">Configuraci√≥n de los forwarder</h4>
<p>Hemos visto que por defecto nuestro servidor har√° consultas iterativas empezando por el servidor ra√≠z. Para que realice consultas recursivas preguntando a un servidor DNS configurado por nosotros (forwarder), todo lo que se requiere es simplemente agregar los n√∫meros de IP de los servidores DNS deseados en la secci√≥n "forwarders".</p>
<p>Simplemente descomenta y edita lo siguiente en <code>/etc/bind/named.conf.options</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">forwarders {</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">8.8.8.8;</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">8.8.4.4;</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">};</span>
</code></pre></div>
<p>Aqu√≠ hemos configurado los DNS de google. </p>
<p>Reinicia el servicio para activarlos.</p>
<h4 id="comprobacion-del-funcionamiento-de-la-cache">Comprobaci√≥n del funcionamiento de la cach√©</h4>
<p>Por defecto bind9 tiene la cach√© habilitada. Podemos probar su funcionamiento de una forma r√°pida y sencilla.</p>
<p>Haz un dig a un dominio que no hayas consultado nunca antes y f√≠jate en el "Query time". Inmediatamente vuelve a realizar la misma consulta y comprubeba el "Query time" ahora. Deber√≠a haber habido un descenso dr√°stico debido al uso de la cach√©. ¬øEs as√≠?</p>
<p>Podr√≠amos configurar muchas otras cosas, pero para nuestros objetivos actuales es suficiente.</p>
<!-- 
Ahora editaremos el archivo `named.conf.options` e incluiremos los siguientes contenidos:

 + Si, por motivos de seguridad, quisi√©ramos que solo los equipos de nuestra red local o empresarial pudieran hacer consultas recursivas al servidor, incluir√≠amos una lista de acceso.

    Imagina que los hosts confiables fueran los de la red 192.168.X.0/24 (donde la X depende de vuestra red de casa). As√≠ pues, justo antes del bloque ```options {‚Ä¶}```, al principio del archivo, a√±adir√≠amos algo as√≠:

    ![](P5_1/3.1.bind_2.png)

    En el caso que nuestro servidor se encuentre en AWS no podemos saber, a priori, con qu√© IP p√∫blica llegar√°n al servidor bind9 nuestras peticiones, as√≠ que no incluiremos esta directiva.

+ Si nos fijamos el servidor por defecto ya viene configurado para ser un DNS cach√©. El directorio donde se cachear√°n o guardar√°n las zonas es `/var/cache/bind`.

    <div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>/var/cache/bind
</code></pre></div>


+ Que s√≥lo se permitan las consultas recursivas a los hosts que hemos decidido en la lista de acceso anterior

+ No permitir transferencia de zonas a nadie, de momento

+ Configurar el servidor para que escuche consultas DNS en el puerto 53 (por defecto DNS utiliza puerto 53 UDP) y en la IP de su interfaz de la red privada. <u>**Deber√©is colocar la IP de la interfaz de vuestra Debian**</u>, puesto que resolver√° las consultas DNS del cliente/s de esa red.

+ Permitir las consultas recursivas, ya que en el primer punto ya le hemos dicho que s√≥lo puedan hacerlas los hosts de la ACL.

+ Adem√°s, vamos a comentar la l√≠nea que pone `listen-on-v6 { any; };` puesto que no vamos a responder a consultas de IPv6. Para [comentarla](http://astro.uni-tuebingen.de/software/bind/comments.html) basta a√±adir al principio de la l√≠nea dos barras `//`. Tambi√©n podr√≠a hacerse con una almohadilla pero aparecer√≠a resaltado con color ya que estos comentarios los suele utilizar el administrador para aclarar alg√∫n aspecto de la configuraci√≥n.

    ![](P5_1/3.1.bind_3.png)



Vayamos paso por paso. En p
Podemos comprobar si nuestra configuraci√≥n es correcta con el comando:

![](P5_1/3.1.bind_4.png)

Si hay alg√∫n error, nos lo har√° saber. En caso contrario, nos devuelve a la l√≠nea de comandos. 

Reiniciamos el servidor y comprobamos su estado:

![](P5_1/3.1.bind_5.png)
-->

<h3 id="configuracion-namedconflocal">Configuraci√≥n <em>named.conf.local</em></h3>
<p>En este archivo configuraremos aspectos relativos a nuestras zonas. Vamos a declarar la zona ‚Äúdeaw.es‚Äù. Por ahora simplemente indicaremos que el servidor DNS es maestro para esta zona y donde estar√° ubicado el archivo de zona que crearemos m√°s adelante:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>//
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>//<span class="w"> </span>Do<span class="w"> </span>any<span class="w"> </span><span class="nb">local</span><span class="w"> </span>configuration<span class="w"> </span>here
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>//
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>//<span class="w"> </span>Consider<span class="w"> </span>adding<span class="w"> </span>the<span class="w"> </span><span class="m">1918</span><span class="w"> </span>zones<span class="w"> </span>here,<span class="w"> </span><span class="k">if</span><span class="w"> </span>they<span class="w"> </span>are<span class="w"> </span>not<span class="w"> </span>used<span class="w"> </span><span class="k">in</span><span class="w"> </span>your
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>//<span class="w"> </span>organization
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>//include<span class="w"> </span><span class="s2">&quot;/etc/bind/zones.rfc1918&quot;</span><span class="p">;</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>zone<span class="w"> </span><span class="s2">&quot;deaw.es&quot;</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">        </span><span class="nb">type</span><span class="w"> </span>master<span class="p">;</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">        </span>file<span class="w"> </span><span class="s2">&quot;/etc/bind/db.deaw.es&quot;</span><span class="p">;</span><span class="w">  </span>//Ruta<span class="w"> </span>donde<span class="w"> </span>ubicamos<span class="w"> </span>nuestro<span class="w"> </span>archivo<span class="w"> </span>de<span class="w"> </span>zona
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="o">}</span><span class="p">;</span>
</code></pre></div>
<h3 id="creacion-del-archivo-de-zona">Creaci√≥n del archivo de zona</h3>
<p>Vamos a crear el archivo de zona de resoluci√≥n directa justo en el directorio que hemos indicado antes y con el mismo nombre que hemos indicado antes.</p>
<p>El contenido de <code>/etc/bind/db.deaw.es</code> ser√° algo as√≠ (procurad respetar el formato):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nv">$TTL</span><span class="w"> </span>1d
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="nv">$ORIGIN</span><span class="w"> </span>deaw.es.<span class="w"> </span><span class="p">;</span><span class="w"> </span>base<span class="w"> </span>domain-name
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>@<span class="w">   </span>IN<span class="w">  </span>SOA<span class="w">     </span>ns1.deaw.es.<span class="w"> </span>admin.deaw.es.<span class="w"> </span><span class="o">(</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">                  </span><span class="m">2023112301</span><span class="w">  </span><span class="p">;</span><span class="w"> </span>Serial
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">                  </span>8H<span class="w">          </span><span class="p">;</span><span class="w"> </span>Refresh
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="w">                  </span>2H<span class="w">          </span><span class="p">;</span><span class="w"> </span>Retry
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">                  </span>4W<span class="w">          </span><span class="p">;</span><span class="w"> </span>Expire
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">                  </span>1D<span class="w"> </span><span class="o">)</span><span class="w">        </span><span class="p">;</span><span class="w"> </span>Minimum<span class="w"> </span>TTL
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="p">;</span><span class="w"> </span>Name<span class="w"> </span>Servers
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="w">    </span>IN<span class="w">  </span>NS<span class="w">      </span>ns1.deaw.es.
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="p">;</span><span class="w"> </span>A<span class="w"> </span>records
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>ns1<span class="w"> </span>IN<span class="w">  </span>A<span class="w">       </span><span class="m">3</span>.85.104.173
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>www<span class="w"> </span>IN<span class="w">  </span>A<span class="w">       </span><span class="m">3</span>.85.104.173
</code></pre></div>
<p>Ojo, las √∫ltimas IP son la IP que tiene tu servidor Debian. C√°mbiala por la que proceda.</p>
<p>Explicaci√≥n de las partes del archivo:</p>
<ul>
<li>
<p>$TTL: Tiempo de vida predeterminado para los registros de la zona. En este caso, se establece en 1 d√≠a.</p>
</li>
<li>
<p>SOA (Start of Authority): Indica informaci√≥n sobre la zona, como el nombre del servidor primario, el contacto del administrador y detalles de tiempo.</p>
<ul>
<li>Recuerda tambi√©n incrementar el n√∫mero de serie cada vez que realices cambios para que las actualizaciones se propaguen correctamente.</li>
</ul>
</li>
<li>
<p>NS: Registra los servidores de nombres autoritativos para la zona.</p>
</li>
<li>
<p>A: Registra la direcci√≥n IP asociada con un nombre de host espec√≠fico.</p>
</li>
</ul>
<p>Guarda el archivo. Comprueba que no hay errores con <code>named-checkconf</code> de una forma m√°s avanzada. En este caso necesitar√° 2 par√°metros: el nombre de zona y el archivo de zona:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>named-checkzone<span class="w"> </span>deaw.es<span class="w"> </span>/etc/bind/db.deaw.es
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>zone<span class="w"> </span>deaw.es/IN:<span class="w"> </span>loaded<span class="w"> </span>serial<span class="w"> </span><span class="m">2023112301</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>OK
</code></pre></div>
<p>Vemos c√≥mo si va todo bien nos dir√° el n√∫mero de serie y Ok. Si hubiera alg√∫n error nos dir√≠a algo como </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>zone<span class="w"> </span>deaw.es/IN:<span class="w"> </span>NS<span class="w"> </span><span class="s1">&#39;ns1.deaw.es&#39;</span><span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>address<span class="w"> </span>records<span class="w"> </span><span class="o">(</span>A<span class="w"> </span>or<span class="w"> </span>AAAA<span class="o">)</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>zone<span class="w"> </span>deaw.es/IN:<span class="w"> </span>not<span class="w"> </span>loaded<span class="w"> </span>due<span class="w"> </span>to<span class="w"> </span>errors.
</code></pre></div>
<p>Si va todo bien reinicia el servicio.</p>
<p>Prueba a preguntar por www.deaw.es o ns1.deaw.es a tu servidor.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>nslookup<span class="w"> </span>www.deaw.es<span class="w">            </span>//desde<span class="w"> </span>el<span class="w"> </span>propio<span class="w"> </span>servidor
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>nslookup<span class="w"> </span>www.deaw.es<span class="w"> </span>IP_SERVER<span class="w">  </span>//desde<span class="w"> </span>tu<span class="w"> </span>equipo<span class="w"> </span><span class="nb">local</span>
</code></pre></div>
<p>Prueba a preguntar con <code>dig</code> por el dominio deaw.es:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>$<span class="w"> </span>dig<span class="w"> </span>deaw.es
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="p">;</span><span class="w"> </span>&lt;&lt;&gt;&gt;<span class="w"> </span>DiG<span class="w"> </span><span class="m">9</span>.18.19-1~deb12u1-Debian<span class="w"> </span>&lt;&lt;&gt;&gt;<span class="w"> </span>deaw.es
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="p">;;</span><span class="w"> </span>global<span class="w"> </span>options:<span class="w"> </span>+cmd
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="p">;;</span><span class="w"> </span>Got<span class="w"> </span>answer:
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="p">;;</span><span class="w"> </span>-&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de:<span class="w"> </span>QUERY,<span class="w"> </span>status:<span class="w"> </span>NOERROR,<span class="w"> </span>id:<span class="w"> </span><span class="m">31053</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="p">;;</span><span class="w"> </span>flags:<span class="w"> </span>qr<span class="w"> </span>aa<span class="w"> </span>rd<span class="w"> </span>ra<span class="p">;</span><span class="w"> </span>QUERY:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>ANSWER:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>AUTHORITY:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>ADDITIONAL:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="p">;;</span><span class="w"> </span>OPT<span class="w"> </span>PSEUDOSECTION:
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="p">;</span><span class="w"> </span>EDNS:<span class="w"> </span>version:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>flags:<span class="p">;</span><span class="w"> </span>udp:<span class="w"> </span><span class="m">1232</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="p">;</span><span class="w"> </span>COOKIE:<span class="w"> </span>535eb708a167a587010000006560f94758cba602eeb2f207<span class="w"> </span><span class="o">(</span>good<span class="o">)</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="p">;;</span><span class="w"> </span>QUESTION<span class="w"> </span>SECTION:
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="p">;</span>deaw.es.<span class="w">           </span>IN<span class="w">  </span>A
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="p">;;</span><span class="w"> </span>AUTHORITY<span class="w"> </span>SECTION:
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>deaw.es.<span class="w">        </span><span class="m">86400</span><span class="w">   </span>IN<span class="w">  </span>SOA<span class="w"> </span>ns1.deaw.es.<span class="w"> </span>admin.deaw.es.<span class="w"> </span><span class="m">2023112301</span><span class="w"> </span><span class="m">28800</span><span class="w"> </span><span class="m">7200</span><span class="w"> </span><span class="m">2419200</span><span class="w"> </span><span class="m">86400</span>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="p">;;</span><span class="w"> </span>Query<span class="w"> </span>time:<span class="w"> </span><span class="m">0</span><span class="w"> </span>msec
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a><span class="p">;;</span><span class="w"> </span>SERVER:<span class="w"> </span><span class="m">127</span>.0.0.1#53<span class="o">(</span><span class="m">127</span>.0.0.1<span class="o">)</span><span class="w"> </span><span class="o">(</span>UDP<span class="o">)</span>
<a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a><span class="p">;;</span><span class="w"> </span>WHEN:<span class="w"> </span>Fri<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">19</span>:28:07<span class="w"> </span>UTC<span class="w"> </span><span class="m">2023</span>
<a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a><span class="p">;;</span><span class="w"> </span>MSG<span class="w"> </span>SIZE<span class="w">  </span>rcvd:<span class="w"> </span><span class="m">110</span>
</code></pre></div>
<p>Observa los datos que te devuelve y comp√°ralos con el fichero de configuraci√≥n de la zona. </p>
<div class="admonition task">
<p class="admonition-title">Task</p>
<p>Haz un dig de otros dominios conocidos como cisco.com o google.com y analiza el resultado</p>
</div>
<h3 id="creacion-del-archivo-de-zona-para-la-resolucion-inversa">Creaci√≥n del archivo de zona para la resoluci√≥n inversa</h3>
<p>Recordad que deben existir ambos archivos de zona, uno para la resoluci√≥n directa y otro para la inversa. Vamos pues a crear el archivo de zona inversa.</p>
<p>En primer lugar, debemos a√±adir las l√≠neas correspondientes a esta zona inversa en el archivo
<strong><code>/etc/bind/named.conf.local</code></strong>, igual que hemos hecho antes con la zona de resoluci√≥n directa:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>zone<span class="w"> </span><span class="s2">&quot;104.85.3.in-addr.arpa&quot;</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="nb">type</span><span class="w"> </span>master<span class="p">;</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">    </span>file<span class="w"> </span><span class="s2">&quot;/etc/bind/db.3.85.104&quot;</span><span class="p">;</span><span class="w">  </span><span class="c1"># Ruta al archivo de zona inversa</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="o">}</span><span class="p">;</span>
</code></pre></div>
Y la configuraci√≥n de la zona de resoluci√≥n inversa la realizaremos en el fichero descrito  "/etc/bind/db.3.85.104" :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="nv">$TTL</span><span class="w"> </span>1d
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="nv">$ORIGIN</span><span class="w"> </span><span class="m">104</span>.85.3.IN-ADDR.ARPA.
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>@<span class="w">   </span>IN<span class="w">  </span>SOA<span class="w">     </span>ns1.deaw.es.<span class="w"> </span>admin.deaw.es.<span class="w"> </span><span class="o">(</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">                  </span><span class="m">2023112301</span><span class="w">  </span><span class="p">;</span><span class="w"> </span>Serial
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">                  </span>8H<span class="w">          </span><span class="p">;</span><span class="w"> </span>Refresh
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="w">                  </span>2H<span class="w">          </span><span class="p">;</span><span class="w"> </span>Retry
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="w">                  </span>4W<span class="w">          </span><span class="p">;</span><span class="w"> </span>Expire
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="w">                  </span>1D<span class="w"> </span><span class="o">)</span><span class="w">        </span><span class="p">;</span><span class="w"> </span>Minimum<span class="w"> </span>TTL
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="p">;</span><span class="w"> </span>Name<span class="w"> </span>Servers
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="w">    </span>IN<span class="w">  </span>NS<span class="w">      </span>ns1.deaw.es.
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="p">;</span><span class="w"> </span>PTR<span class="w"> </span>record
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="m">173</span><span class="w"> </span>IN<span class="w">  </span>PTR<span class="w">     </span>ns1.deaw.es.<span class="w"> </span><span class="p">;</span><span class="w"> </span>fully<span class="w"> </span>qualified<span class="w"> </span>domain<span class="w"> </span>name<span class="w"> </span><span class="o">(</span>FQDN<span class="o">)</span>
</code></pre></div>
<p>Vuelve a comprobar que la configuraci√≥n es correcta:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>sudo<span class="w"> </span>named-checkzone<span class="w"> </span><span class="m">104</span>.85.3.in-addr.arpa<span class="w"> </span>/etc/bind/db.3.85.104<span class="w"> </span>
</code></pre></div>
<p>Reinicia el servicio y ejecuta los comandos de comprobaci√≥n.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>nslookup<span class="w"> </span><span class="m">3</span>.85.104.173<span class="w">           </span>//desde<span class="w"> </span>el<span class="w"> </span>propio<span class="w"> </span>servidor
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>nslookup<span class="w"> </span><span class="m">3</span>.85.104.173<span class="w"> </span>IP_SERVER<span class="w"> </span>//desde<span class="w"> </span>tu<span class="w"> </span>equipo<span class="w"> </span><span class="nb">local</span>
</code></pre></div>
<p>Comprueba con <code>dig -x</code> la resoluci√≥n inversa:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>$<span class="w"> </span>dig<span class="w"> </span>-x<span class="w"> </span><span class="m">3</span>.85.104.173
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="p">;</span><span class="w"> </span>&lt;&lt;&gt;&gt;<span class="w"> </span>DiG<span class="w"> </span><span class="m">9</span>.18.19-1~deb12u1-Debian<span class="w"> </span>&lt;&lt;&gt;&gt;<span class="w"> </span>-x<span class="w"> </span><span class="m">3</span>.85.104.173
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="p">;;</span><span class="w"> </span>global<span class="w"> </span>options:<span class="w"> </span>+cmd
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="p">;;</span><span class="w"> </span>Got<span class="w"> </span>answer:
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="p">;;</span><span class="w"> </span>-&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de:<span class="w"> </span>QUERY,<span class="w"> </span>status:<span class="w"> </span>NOERROR,<span class="w"> </span>id:<span class="w"> </span><span class="m">44375</span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="p">;;</span><span class="w"> </span>flags:<span class="w"> </span>qr<span class="w"> </span>aa<span class="w"> </span>rd<span class="w"> </span>ra<span class="p">;</span><span class="w"> </span>QUERY:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>ANSWER:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>AUTHORITY:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>ADDITIONAL:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="p">;;</span><span class="w"> </span>OPT<span class="w"> </span>PSEUDOSECTION:
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="p">;</span><span class="w"> </span>EDNS:<span class="w"> </span>version:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>flags:<span class="p">;</span><span class="w"> </span>udp:<span class="w"> </span><span class="m">1232</span>
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="p">;</span><span class="w"> </span>COOKIE:<span class="w"> </span>727f64c781f9f648010000006560f9ee4cbddffde4f5df09<span class="w"> </span><span class="o">(</span>good<span class="o">)</span>
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="p">;;</span><span class="w"> </span>QUESTION<span class="w"> </span>SECTION:
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a><span class="p">;</span><span class="m">173</span>.104.85.3.in-addr.arpa.<span class="w"> </span>IN<span class="w">  </span>PTR
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>
<a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a><span class="p">;;</span><span class="w"> </span>ANSWER<span class="w"> </span>SECTION:
<a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a><span class="m">173</span>.104.85.3.IN-ADDR.ARPA.<span class="w"> </span><span class="m">86400</span><span class="w"> </span>IN<span class="w"> </span>PTR<span class="w"> </span>ns1.deaw.es.
<a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a>
<a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a><span class="p">;;</span><span class="w"> </span>Query<span class="w"> </span>time:<span class="w"> </span><span class="m">0</span><span class="w"> </span>msec
<a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a><span class="p">;;</span><span class="w"> </span>SERVER:<span class="w"> </span><span class="m">127</span>.0.0.1#53<span class="o">(</span><span class="m">127</span>.0.0.1<span class="o">)</span><span class="w"> </span><span class="o">(</span>UDP<span class="o">)</span>
<a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a><span class="p">;;</span><span class="w"> </span>WHEN:<span class="w"> </span>Fri<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">19</span>:30:54<span class="w"> </span>UTC<span class="w"> </span><span class="m">2023</span>
<a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a><span class="p">;;</span><span class="w"> </span>MSG<span class="w"> </span>SIZE<span class="w">  </span>rcvd:<span class="w"> </span><span class="m">132</span>
</code></pre></div>
<h2 id="cuestiones-finales">Cuestiones finales</h2>
<div class="admonition task">
<p class="admonition-title">Cuesti√≥n 1</p>
<p>¬øQu√© pasar√° si un cliente de una red diferente a la tuya intenta hacer uso de tu DNS de alguna manera, le funcionar√°?¬øPor qu√©, en qu√© parte de la configuraci√≥n puede verse?</p>
</div>
<div class="admonition task">
<p class="admonition-title">Cuesti√≥n 2</p>
<p>¬øPor qu√© tenemos que permitir las consultas recursivas en la configuraci√≥n?</p>
</div>
<div class="admonition task">
<p class="admonition-title">Cuesti√≥n 3</p>
<p>El servidor DNS que acab√°is de montar, ¬øes autoritativo? ¬øPor qu√©?</p>
</div>
<div class="admonition task">
<p class="admonition-title">Cuesti√≥n 4</p>
<p>¬øD√≥nde podemos encontrar la directiva $ORIGIN y para qu√© sirve?</p>
</div>
<div class="admonition task">
<p class="admonition-title">Cuesti√≥n 5</p>
<p>¬øUna zona es id√©ntico a un dominio? </p>
</div>
<div class="admonition task">
<p class="admonition-title">Cuesti√≥n 6</p>
<p>¬øPueden editarse los archivos de zona de un servidor esclavo/secundario?</p>
</div>
<div class="admonition task">
<p class="admonition-title">Cuesti√≥n 7</p>
<p>¬øPor qu√© podr√≠a querer tener m√°s de un servidor esclavo para una misma zona?</p>
</div>
<div class="admonition task">
<p class="admonition-title">Cuesti√≥n 8</p>
<p>¬øCu√°ntos servidores ra√≠z existen?</p>
</div>
<div class="admonition task">
<p class="admonition-title">Cuesti√≥n 9</p>
<p>¬øQu√© es una consulta iterativa de referencia?</p>
</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "toc.integrate", "search.highlight", "content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>